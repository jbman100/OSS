<!DOCTYPE html>
<head>
    <meta charset=utf-8>
    <link rel="stylesheet" type="text/css" href="http://skutnik.iiens.net/github_like.css">
    <link rel="stylesheet" type="text/css" href="http://skutnik.iiens.net/colors.css">
    <link rel="shortcut icon" href="http://skutnik.iiens.net/icon.png" type="image/x-icon">
    <title>spoutnik.com</title>
</head>
<p><a href="http://skutnik.iiens.net/cours/OSS">Retour au sommaire</a></p>
<h1>Scripts en bash</h1>
<h2>Création</h2>
<p>Un script bash est une liste de commandes à effectuer par <code>bash</code>. Il suffit d'écrire cette liste dans un fichier, de préférence de nom terminant par <code>.sh</code>. Ensuite, <strong>il fait dire au terminal d'exécuter le fichier</strong>. Il existe deux possibilités:</p>
<ul>
<li>On utilise <code>bash</code>: <code>bash [fichier]</code> qui va dire au programme <code>bash</code> d'exécuter <code>[fichier]</code></li>
<li>On ajoute <code>#!/bin/bash</code> en première ligne du fichier; puis on effectue <code>chmod +x [fichier]</code> et enfin <code>./[fichier]</code>. Ça a pour effet de dire au terminal d'utiliser <code>bash</code> pour lire le fichier. C'est préférable à l'option précédente.</li>
</ul>
<pre lang=shell><code><span class="highlight"><span class="c">#!/bin/bash</span>

<span class="k">if</span> <span class="o">!</span> <span class="o">[</span> <span class="k">$(</span>which ruby<span class="k">)</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then
    </span><span class="nb">echo </span>You <span class="k">do </span>not have ruby installed <span class="o">!</span>
    <span class="nb">exit </span>1
<span class="k">fi

function </span>check_for_gem<span class="o">()</span> <span class="o">{</span>
    <span class="nv">gem</span><span class="o">=</span><span class="k">$(</span>gem list | <span class="nb">grep</span> <span class="nv">$1</span><span class="k">)</span>

    <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">: </span><span class="nv">$gem</span><span class="s2">"</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$gem</span><span class="s2">"</span> <span class="o">!=</span> <span class="s2">""</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then
	</span><span class="nb">echo</span> <span class="s2">"Gem </span><span class="nv">$1</span><span class="s2"> has been found"</span>
    <span class="k">else
	</span><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"The gem </span><span class="nv">$1</span><span class="s2"> is not installed. Install ? [Y/n] "</span>
	<span class="nb">read </span>answer

	<span class="k">if</span> <span class="o">!</span> <span class="o">[</span> <span class="nv">$answer</span> <span class="o">==</span> <span class="s2">"n"</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then
	    </span>gem install <span class="nv">$1</span>
	<span class="k">else
	    </span><span class="nb">exit </span>1
	<span class="k">fi
    fi</span>
<span class="o">}</span>

check_for_gem commonmarker
check_for_gem github-markup

mkdir <span class="nt">-p</span> <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">"</span>/.local/bin
cp ./mdtoml <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">"</span>/.local/bin
chmod +x <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">"</span>/.local/bin/mdtoml

<span class="nb">echo
echo</span> <span class="s2">"mdtoml has been copied to /home/"</span><span class="nv">$USER</span><span class="s2">"/.local/bin/mdtoml"</span>
<span class="nb">echo</span> <span class="s2">"You may need to update your PATH. See:"</span>
<span class="nb">echo</span> <span class="s2">"https://wiki.archlinux.org/index.php/environment_variables"</span>
<span class="nb">echo</span>
</span></code></pre>
<p>test test2</p>
